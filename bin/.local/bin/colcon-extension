#!/bin/bash

CURRENT_DIR=$PWD
LOG_BASE=$CURRENT_DIR/log
BASE_PATHS=$CURRENT_DIR/src
INSTALL_BASE=$CURRENT_DIR/install
BUILD_BASE=$CURRENT_DIR/build

SELECTED=$(colcon list -n --base-path $BASE_PATHS | fzf -m)

if [[ -z $SELECTED ]]; then
    exit 0
fi


colcon build \
    --base-paths $BASE_PATHS \
    --install-base $INSTALL_BASE \
    --build-base $BUILD_BASE \
    --packages-select $SELECTED

source $INSTALL_BASE/local_setup.bash
echo "[colcon-extension]: The workspace has been source."
